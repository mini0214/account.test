<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <title>測試 GAS 總額 API</title>
</head>
<body>
  <h2>測試 GAS 總額 API</h2>
  <button id="testBtn">查詢總額</button>

  <pre id="resultBox"></pre>

  <script>
    const API_URL = "https://script.google.com/macros/s/AKfycbyUMsMeqA4Su0G6BKE8AYTTnz5wHzNbwtNCYPFQoWwAu7IJ9fV5YOUT_gL49RiCa44GIA/exec"; // 🔹 換成你的 GAS Web App URL

    document.getElementById("testBtn").addEventListener("click", async () => {
      const resultBox = document.getElementById("resultBox");
      resultBox.textContent = "查詢中...";

      try {
        const res = await fetch(API_URL, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            type: "query",
            command: "總額",
            user: "Betty Yi"   // 🔹 直接測試用
          })
        });

        if (!res.ok) throw new Error("HTTP 錯誤: " + res.status);

        const data = await res.json();
        resultBox.textContent = JSON.stringify(data, null, 2);
        alert("查詢結果:\n" + JSON.stringify(data, null, 2));
      } catch (err) {
        resultBox.textContent = "❌ 查詢失敗: " + err.message;
        alert("❌ 查詢失敗: " + err.message);
      }
    });
  </script>
</body>
</html>

