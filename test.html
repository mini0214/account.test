<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>æ¸¬è©¦ GAS è¨˜å¸³è€…æœ¬æœŸ/ä¸ŠæœŸ</title>
<style>
  body { font-family: Arial, sans-serif; padding: 20px; }
  table { border-collapse: collapse; margin-top: 20px; width: 50%; }
  th, td { border: 1px solid #999; padding: 8px 12px; text-align: center; }
  th { background: #eee; }
  pre { background: #f4f4f4; padding: 10px; border-radius: 6px; }
</style>
</head>
<body>

<h2>ğŸ“Š è¨˜å¸³è€…æœ¬æœŸ / ä¸ŠæœŸæ¸¬è©¦</h2>
<button onclick="testQueryè¨˜å¸³è€…()">ğŸ” æŸ¥è©¢è¨˜å¸³è€…</button>

<div id="resultBox"></div>

<script>
async function testQueryè¨˜å¸³è€…() {
  const apiUrl = "https://script.google.com/macros/s/AKfycby-rxd7N7NUMnZp321Kj7o9DCmo2ULp1ZsnzxQcaWzr3Bry9BJpaUtZdJ6b6sZDNLxoKw/exec";

  const payload = {
    type: "query",
    command: "è¨˜å¸³è€…",
    startDate: "2025-10-01",
    endDate: "2025-10-31"
  };

  try {
    const res = await fetch(apiUrl, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(payload)
    });

    const data = await res.json();

    if (data.fixedUsers) {
      // ç”Ÿæˆè¡¨æ ¼
      let html = `<table>
        <tr>
          <th>è¨˜å¸³è€…</th>
          <th>æœ¬æœŸç¸½é¡</th>
          <th>ä¸ŠæœŸç¸½é¡</th>
        </tr>`;

      Object.entries(data.fixedUsers).forEach(([name, obj]) => {
        html += `<tr>
          <td>${name}</td>
          <td>${obj.current}</td>
          <td>${obj.last}</td>
        </tr>`;
      });

      html += `</table>`;
      document.getElementById("resultBox").innerHTML = html;

    } else {
      document.getElementById("resultBox").innerHTML = "âš ï¸ æ²’æœ‰æ”¶åˆ° fixedUsersï¼Œè«‹æª¢æŸ¥ GAS ç¨‹å¼ã€‚";
    }

  } catch (err) {
    document.getElementById("resultBox").innerText = "âŒ é€£ç·šéŒ¯èª¤: " + err.message;
  }
}
</script>

</body>
</html>

