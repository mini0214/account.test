<script>
async function testQueryè¨˜å¸³è€…() {
  const apiUrl = "https://script.google.com/macros/s/AKfycbw_sGZN1eGjvPTg1SGA_8C56bC26lpL96cm8m-PiiYOnkNTB7VZMflj1oxfdPkl8M4E-g/exec";

  const payload = {
    type: "query",
    command: "è¨˜å¸³è€…",
    startDate: "2025-10-01",
    endDate: "2025-10-31"
  };

  try {
    // å‘¼å« doPost()
    const res = await fetch(apiUrl, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(payload)
    });

    // è§£æå›å‚³
    const data = await res.json();
    console.log("âœ… å›å‚³è³‡æ–™ï¼š", data);

    // é¡¯ç¤º fixedUsers çµæœï¼ˆæ¯ä½è¨˜å¸³è€…ä¸ŠæœŸ vs æœ¬æœŸï¼‰
    if (data.fixedUsers) {
      document.getElementById("resultBox").innerText =
        JSON.stringify(data.fixedUsers, null, 2);
    } else {
      document.getElementById("resultBox").innerText =
        "âš ï¸ æ²’æœ‰æ”¶åˆ° fixedUsersï¼Œè«‹æª¢æŸ¥ GAS ç¨‹å¼ã€‚";
    }

  } catch (err) {
    console.error("âŒ ç™¼ç”ŸéŒ¯èª¤ï¼š", err);
    document.getElementById("resultBox").innerText = "ç™¼ç”ŸéŒ¯èª¤ï¼š" + err.message;
  }
}

<button onclick="testQueryè¨˜å¸³è€…()">ğŸ” æ¸¬è©¦æŸ¥è©¢è¨˜å¸³è€…</button>
<pre id="resultBox" style="margin-top:10px; padding:10px; background:#f4f4f4; border-radius:8px;"></pre>
</script>

