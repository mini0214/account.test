<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <title>æ¸¬è©¦ GAS ç¸½é¡ API</title>
</head>
<body>
  <h2>æ¸¬è©¦ GAS ç¸½é¡ API</h2>
  <button id="testBtn">æŸ¥è©¢ç¸½é¡</button>

  <pre id="resultBox"></pre>

  <script>
    const API_URL = "https://script.google.com/macros/s/AKfycbyUMsMeqA4Su0G6BKE8AYTTnz5wHzNbwtNCYPFQoWwAu7IJ9fV5YOUT_gL49RiCa44GIA/exec"; // ğŸ”¹ æ›æˆä½ çš„ GAS Web App URL

    document.getElementById("testBtn").addEventListener("click", async () => {
      const resultBox = document.getElementById("resultBox");
      resultBox.textContent = "æŸ¥è©¢ä¸­...";

      try {
        const res = await fetch(API_URL, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            type: "query",
            command: "ç¸½é¡",
            user: "Betty Yi"   // ğŸ”¹ ç›´æ¥æ¸¬è©¦ç”¨
          })
        });

        if (!res.ok) throw new Error("HTTP éŒ¯èª¤: " + res.status);

        const data = await res.json();
        resultBox.textContent = JSON.stringify(data, null, 2);
        alert("æŸ¥è©¢çµæœ:\n" + JSON.stringify(data, null, 2));
      } catch (err) {
        resultBox.textContent = "âŒ æŸ¥è©¢å¤±æ•—: " + err.message;
        alert("âŒ æŸ¥è©¢å¤±æ•—: " + err.message);
      }
    });
  </script>
</body>
</html>

