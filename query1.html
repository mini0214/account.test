<div id="queryResult"></div>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<div id="queryResult"></div>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbzp7z2jx-chJ15TGqCNhDuOaJrV92CEGYU-6XrA_qdIjeEg2lFmKwmPZcjfnBthcndbJw/exec"; // ğŸ‘ˆ æ”¹æˆä½ å¾Œç«¯çš„ API
<div id="queryResult"></div>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
const API_URL = "/your/api/url"; // ğŸ‘ˆ æ”¹æˆä½ å¾Œç«¯çš„ API

async function sendQuery(command) {
  const body = { type: "query", command: command };
  const res = await fetch(API_URL, { method: "POST", body: JSON.stringify(body) });
  const json = await res.json();
  console.log("å›å‚³è³‡æ–™ï¼š", json);

  let html = "";

  if (command === "æœ¬æœˆåº—å®¶" && json.stores) {
    html += `<h4>ğŸ“‹ æœ¬æœˆåº—å®¶çµ±è¨ˆ</h4>`;
    html += `<table><tr><th>åº—å®¶</th><th>é‡‘é¡</th><th>å æ¯”</th></tr>`;
    for (const [store, amt] of Object.entries(json.stores)) {
      const percent = ((amt / json.total) * 100).toFixed(1);
      html += `<tr><td>${store}</td><td>${amt}</td><td>${percent}%</td></tr>`;
    }
    html += `</table>`;
    html += `<canvas id="storeChart"></canvas>`;
  }

  document.getElementById("queryResult").innerHTML = html;

  if (command === "æœ¬æœˆåº—å®¶" && json.stores) {
    const ctx = document.getElementById("storeChart").getContext("2d");
    new Chart(ctx, {
      type: "pie",
      data: {
        labels: Object.keys(json.stores),
        datasets: [{ data: Object.values(json.stores) }]
      }
    });
  }
}

// æ¸¬è©¦ç›´æ¥å‘¼å«
sendQuery("æœ¬æœˆåº—å®¶");
</script>
