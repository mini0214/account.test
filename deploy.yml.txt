name: Deploy Pages

on:
  push:
    branches:
      - main  # 你的主要分支

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest

    steps:
      # 1️⃣ 抓 repo
      - uses: actions/checkout@v3

      # 2️⃣ 計算 commit 次數
      - name: Replace title with commit number
        run: |
          COMMIT_NUMBER=$(git rev-list --count HEAD)
          echo "Commit number: $COMMIT_NUMBER"

          # 替換 account.test 資料夾下所有 HTML 的 <title>
          find account.test -name "*.html" -exec sed -i "s/<title>零用金支出帳簿<\/title>/<title>零用金支出帳簿#$COMMIT_NUMBER<\/title>/" {} \;

      # 3️⃣ 部署到 GitHub Pages
      - name: Deploy to GitHub Pages
        uses: peaceiris/actions-gh-pages@v3
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          publish_dir: ./account.test  # 這裡是你的 HTML 目錄
