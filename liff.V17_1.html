<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>é›¶ç”¨é‡‘æ”¯å‡ºå¸³ç°¿</title>
</head>
<body>
  <h3>è¼¸å…¥åº—å®¶</h3>

  <!-- è¼¸å…¥æ¡† -->
  <input list="storeList" id="store" placeholder="è¼¸å…¥æˆ–é¸æ“‡åº—å®¶">
  <!-- è‡ªå‹•æç¤ºæ¸…å–® -->
  <datalist id="storeList"></datalist>

  <button onclick="loadStores()">è¼‰å…¥åº—å®¶æ¸…å–®</button>

  <script>
    // ğŸ”¹ å‘ GAS å–å¾—åº—å®¶æ¸…å–®
    async function loadStores() {
      try {
        const res = await fetch("https://script.google.com/macros/s/ä½ çš„GAS_ID/exec", {
          method: "POST",
          body: JSON.stringify({
            type: "query",
            command: "åº—å®¶",
            startDate: "2025-01-01",  // å¯ä¾éœ€æ±‚å¸¶å€¼
            endDate: "2025-12-31"
          })
        });
        const data = await res.json();

        if (data.ok && data.storeList) {
          const datalist = document.getElementById("storeList");
          datalist.innerHTML = ""; // å…ˆæ¸…ç©º
          data.storeList.forEach(store => {
            const option = document.createElement("option");
            option.value = store;
            datalist.appendChild(option);
          });
          alert("åº—å®¶æ¸…å–®å·²è¼‰å…¥å®Œæˆ âœ…");
        } else {
          alert("æŸ¥ç„¡åº—å®¶æ¸…å–®");
        }
      } catch (err) {
        console.error(err);
        alert("è®€å–åº—å®¶æ¸…å–®å¤±æ•— âŒ");
      }
    }
  </script>
</body>
</html>
