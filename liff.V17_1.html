function doGet(e) {
  // 模擬資料，實際可改為讀 Spreadsheet
  const rows = [
    ["2025-09-25", "Big W", 100],
    ["2025-09-24", "Coles", 50],
    ["2025-09-23", "7-Eleven", 200],
    ["2025-09-22", "Family Mart", 150]
  ];

  // 生成 storeMap
  const storeMap = {};
  rows.forEach(r => {
    const store = r[1] || "未填寫";
    storeMap[store] = (storeMap[store] || 0) + (Number(r[2]) || 0);
  });

  const result = {
    ok: true,
    type: "query",
    command: "店家",
    rows: rows,
    stores: storeMap,
    storeList: Object.keys(storeMap)
  };

  return ContentService.createTextOutput(JSON.stringify(result))
    .setMimeType(ContentService.MimeType.JSON)
    .setHeader("Access-Control-Allow-Origin", "*"); // ✅ 讓前端 fetch 不會被擋
}
